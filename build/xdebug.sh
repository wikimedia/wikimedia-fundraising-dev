cat << EOF > /tmp/default-xdebug3.ini
#### Customize xdebug settings here
#### Note: This file is automatically generated by setup.sh and is ignored by git, so
#### changes will not be tracked. For defaults, see setup.sh.
#### Note: client_host, log and mode settings are set inside the container
#### from /srv/config/internal/xdebug-common.ini. However, they can be overriden here.

xdebug.client_port=$XDEBUG_PORT
xdebug.start_with_request=default
xdebug.idekey=PHPSTORM
EOF

create_xdebug_ini() {
  if [[ ! -e "config/$1/xdebug-web.ini" ]]; then
    echo "Creating config/$1/xdebug-web.ini."
    cp /tmp/default-xdebug3.ini "config/$1/xdebug-web.ini"
    echo
  fi

  if [[ ! -e "config/$1/xdebug-cli.ini" ]]; then
    echo "Creating config/$1/xdebug-cli.ini."
    cp /tmp/default-xdebug3.ini "config/$1/xdebug-cli.ini"
    echo
  fi
}

create_xdebug_ini_all() {
  declare -a xdebug3_config_files=(
    "civicrm"
    "civiproxy"
    "core"
    "payments"
    "privatebin"
    "email-pref-ctr"
    "donut"
    "smashpig"
  )

  for i in "${xdebug3_config_files[@]}"
  do
    create_xdebug_ini $i
  done
}

